##########################################################
## III. Combining input data ##########################
##########################################################
list <- fread(paste0(DIR,IN,"optimization_list.csv"))
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, rjson, maps,maptools, spatstat,rgeos, broom, data.table)
# Set working directory
DIR <- "C:\\Users\\will-\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT <- "in\\res_solar"
IN <-  "in\\"
LD<- "LOW"
##########################################################
## III. Combining input data ##########################
##########################################################
list <- fread(paste0(DIR,IN,"optimization_list.csv"))
# Set working directory
DIR <- "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
I
##########################################################
## III. Combining input data ##########################
##########################################################
list <- fread(paste0(DIR,IN,"optimization_list.csv"))
i = 2
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10]))
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"))
View(temp_low)
temp_med <- fread(paste0(DIR,IN,"res_load\\BASE\\", list[i,10],".csv"))
temp_high <- fread(paste0(DIR,IN,"res_load\\HIGH\\", list[i,10],".csv"))
temp_low <- as.data.frame(as.numeric(temp_low[,2]))
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"))
temp_med <- fread(paste0(DIR,IN,"res_load\\BASE\\", list[i,10],".csv"))
temp_high <- fread(paste0(DIR,IN,"res_load\\HIGH\\", list[i,10],".csv"))
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
View(sol)
#convert local to time element
sol$time <- as.POSIXct(sol$local_time_stor)
View(sol)
#convert local to time element
sol$time <- as.POSIXlt(sol$local_time_stor)
#convert local to time element
sol$time <- as.POSIXct(sol$local_time_stor)
View(sol)
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- unique(sol)
View(sol)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- unique(sol[,1:4])
duplicated(sol)
sum(duplicated(sol))
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- unique(sol[,1:3])
sum(duplicated(sol))
View(sol)
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- group_by(time) %>% summarise(gen = mean(generation))
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(time) %>% summarise(gen = mean(generation))
sol$year <- sol$dd_mmm_yy$year
sol$year <- format(sol$time, "%Y")
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(time, year) %>% summarise(gen = mean(generation))
#confirm can divide by 8760
count <- sol1 %>% group_by(year) %>% summarise(count = length(gen))
View(count)
View(sol1)
sol$month <- format(sol$time, "%m")
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(time, year,month) %>% summarise(gen = mean(generation))
#confirm can divide by 8760
count <- sol1 %>% group_by(year,month) %>% summarise(count = length(gen))
View(count)
View(sol1)
View(sol)
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%h")
sol$hour <- format(sol$time, "%H")
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
#confirm can divide by 8760
count <- sol1 %>% group_by(year,month) %>% summarise(count = length(gen))
#confirm can divide by 8760
count <- sol1 %>% group_by(year) %>% summarise(count = length(gen))
View(count)
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
sol$year <- format(sol$time, "%Y")
sol$month <- format(sol$time, "%m")
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%H")
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
View(sol1)
#confirm can divide by 8760
count <- sol1 %>% group_by(year,month) %>% summarise(count = length(gen))
View(count)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
View(sol1)
View(sol)
View(temp_high)
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"), col.names("V","load"))
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"), col.names=("V","load"))
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"), col.names=c("V","load"))
temp_med <- fread(paste0(DIR,IN,"res_load\\BASE\\", list[i,10],".csv"), col.names=c("V","load"))
temp_high <- fread(paste0(DIR,IN,"res_load\\HIGH\\", list[i,10],".csv"), col.names=c("V","load"))
temp_low <- do.call("rbind", replicate(9,temp_low, simplify = FALSE))
View(temp_low)
sol <- sol[,c(5,6,7,8,3)]
View(sol)
year <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016")
month <- c("03","03","03","03","03","03","03","03","03")
day <- c("09","08","14","13","11","10","09","08","13")
hour <- c("02","02","02","02","02","02","02","02","02")
generation <- c(0,0,0,0,0,0,0,0,0)
add <- data.frame(year,month,day,hour,generation)
sol<- rbind(sol,add)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
#confirm can divide by 8760
count <- sol1 %>% group_by(year,month) %>% summarise(count = length(gen))
View(count)
View(sol1)
sol <- sol[complete.cases(sol), ]
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
sol$year <- format(sol$time, "%Y")
sol$month <- format(sol$time, "%m")
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%H")
sol <- sol[,c(5,6,7,8,3)]
sol <- sol[complete.cases(sol), ]
#create appended table
year <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016")
month <- c("03","03","03","03","03","03","03","03","03")
day <- c("09","08","14","13","11","10","09","08","13")
hour <- c("02","02","02","02","02","02","02","02","02")
generation <- c(0,0,0,0,0,0,0,0,0)
add <- data.frame(year,month,day,hour,generation)
sol<- rbind(sol,add)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
#confirm can divide by 8760
count <- sol1 %>% group_by(year,month) %>% summarise(count = length(gen))
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
sol$year <- format(sol$time, "%Y")
sol$month <- format(sol$time, "%m")
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%H")
sol <- sol[,c(5,6,7,8,3)]
sol <- sol[complete.cases(sol), ]
#create appended table
year <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016")
month <- c("03","03","03","03","03","03","03","03","03")
day <- c("09","08","14","13","11","10","09","08","13")
hour <- c("02","02","02","02","02","02","02","02","02")
generation <- c(0,0,0,0,0,0,0,0,0)
add <- data.frame(year,month,day,hour,generation)
sol<- rbind(sol,add)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
View(sol1)
#merge columns
dt <- cbind(sol1[,5], temp_med[,2])
View(dt)
load_list[i]
list[i]
list[i,3],"_", list[i,4]
list[i,3]
list[i,4]
write.csv(dt, paste0(DIR, IN,"all_data\\BASE_", list[i,3],"_", list[i,4]))
write.csv(dt, paste0(DIR, IN,"all_data\\BASE_", list[i,3],"_", list[i,4],".csv"))
# Set working directory
DIR <- "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT <- "in\\res_solar"
IN <-  "in\\"
LD<- "LOW"
list <- fread(paste0(DIR,IN,"optimization_list.csv"))
for (i in 1:length(list)) {
#create load dataframes
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"), col.names=c("V","load"))
temp_low <- do.call("rbind", replicate(9,temp_low, simplify = FALSE))
temp_med <- fread(paste0(DIR,IN,"res_load\\BASE\\", list[i,10],".csv"), col.names=c("V","load"))
temp_med <- do.call("rbind", replicate(9,temp_med, simplify = FALSE))
temp_high <- fread(paste0(DIR,IN,"res_load\\HIGH\\", list[i,10],".csv"), col.names=c("V","load"))
temp_high <- do.call("rbind", replicate(9,temp_high, simplify = FALSE))
#create solar dataframe
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
sol$year <- format(sol$time, "%Y")
sol$month <- format(sol$time, "%m")
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%H")
sol <- sol[,c(5,6,7,8,3)]
sol <- sol[complete.cases(sol), ]
#create appended table
year <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016")
month <- c("03","03","03","03","03","03","03","03","03")
day <- c("09","08","14","13","11","10","09","08","13")
hour <- c("02","02","02","02","02","02","02","02","02")
generation <- c(0,0,0,0,0,0,0,0,0)
add <- data.frame(year,month,day,hour,generation)
sol<- rbind(sol,add)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
#merge columns and write table
dt <- cbind(sol1[,5], temp_med[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\BASE_", list[i,3],"_", list[i,4],".csv"))
dt <- cbind(sol1[,5], temp_high[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\HIGH_", list[i,3],"_", list[i,4],".csv"))
dt <- cbind(sol1[,5], temp_low[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\LOW_", list[i,3],"_", list[i,4],".csv"))
}
length(list)
nrow(list)
View(list)
for (i in 1:nrow(list)) {
#create load dataframes
temp_low <- fread(paste0(DIR,IN,"res_load\\LOW\\", list[i,10],".csv"), col.names=c("V","load"))
temp_low <- do.call("rbind", replicate(9,temp_low, simplify = FALSE))
temp_med <- fread(paste0(DIR,IN,"res_load\\BASE\\", list[i,10],".csv"), col.names=c("V","load"))
temp_med <- do.call("rbind", replicate(9,temp_med, simplify = FALSE))
temp_high <- fread(paste0(DIR,IN,"res_load\\HIGH\\", list[i,10],".csv"), col.names=c("V","load"))
temp_high <- do.call("rbind", replicate(9,temp_high, simplify = FALSE))
#create solar dataframe
sol <- fread(paste0(DIR,IN,"sol_data\\", list[i,3],"_", list[i,4],".csv"))
#convert local to time element
sol$time <- as.POSIXct(strptime(sol$local_time_stor, "%Y-%m-%d %H:%M:%S"))
sol$year <- format(sol$time, "%Y")
sol$month <- format(sol$time, "%m")
sol$day <- format(sol$time, "%d")
sol$hour <- format(sol$time, "%H")
sol <- sol[,c(5,6,7,8,3)]
sol <- sol[complete.cases(sol), ]
#create appended table
year <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016")
month <- c("03","03","03","03","03","03","03","03","03")
day <- c("09","08","14","13","11","10","09","08","13")
hour <- c("02","02","02","02","02","02","02","02","02")
generation <- c(0,0,0,0,0,0,0,0,0)
add <- data.frame(year,month,day,hour,generation)
sol<- rbind(sol,add)
#drop feb 29 data (maybe by dropping duplicates)
sol1 <- sol %>% group_by(year,month, day, hour) %>% summarise(gen = mean(generation))
#merge columns and write table
dt <- cbind(sol1[,5], temp_med[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\BASE_", list[i,3],"_", list[i,4],".csv"))
dt <- cbind(sol1[,5], temp_high[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\HIGH_", list[i,3],"_", list[i,4],".csv"))
dt <- cbind(sol1[,5], temp_low[,2])
write.csv(dt, paste0(DIR, IN,"all_data\\LOW_", list[i,3],"_", list[i,4],".csv"))
}
warnings()
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, rjson, maps,maptools, spatstat,rgeos, broom, data.table)
list <- list.files(paste0(DIR,IN,"all_data\\R files"))
DIR <- "G:\\Team Drives\\grid_defect_data\\Analysis\\"
IN <-  "in\\"
list <- list.files(paste0(DIR,IN,"all_data\\R files"))
i = 1
readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i])
readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
out <- readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
View(out)
DIR <- "G:\\Team Drives\\grid_defect_data\\Analysis\\"
IN <-  "in\\"
list <- list.files(paste0(DIR,IN,"all_data\\R files"))
for (i in 1:nrow(list)) {
out <- readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
write.csv(out,paste0(DIR, IN,"all_data\\",list[i],".csv"))
}
for (i in 1:length(list)) {
out <- readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
write.csv(out,paste0(DIR, IN,"all_data\\",list[i],".csv"))
}
