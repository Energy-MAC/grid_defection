#bring together
sizing <- merge(sizing,reliability,by=c("county","state","case"))
#Set costs (2 cases )
BAT_COST = 100 # $/kWh
PV_COST = 600 # $/kW
LOAD_COST = 650 # $/kW peak load
OM_COST = 12 # $/kW peak load per year
#annual rates
int_rate = 0.04 # percentage interest rate
bat_life = 10 # years
sol_life = 25 # years
inv_life = 10 # years
BAT_RATE = int_rate / (1 - (1+int_rate)^(-bat_life))
PV_RATE = int_rate / (1 - (1+int_rate)^(-sol_life))
INVT_RATE = int_rate / (1 - (1+int_rate)^(-inv_life))
sizing$grid_defect_cost <- sizing$pv * PV_COST * PV_RATE + sizing$storage * BAT_COST * BAT_RATE +
sizing$max_load * LOAD_COST * INVT_RATE + OM_COST * sizing$max_load
sizing$pv_lev <- (PV_COST * PV_RATE +
LOAD_COST * INVT_RATE +
OM_COST ) / (sizing$gen/9)
sizing$pv_size_load_offset <- sizing$energy / (sizing$gen/9)
sizing$cap_ex <- sizing$pv * PV_COST  + sizing$storage * BAT_COST +
sizing$max_load * LOAD_COST
sizing$reliability <- as.numeric(sizing$reliability)
sizes <- merge(sizing, fips, by=c("county","state"))
##merge in data
defect <- merge(base_rates, sizing[,c(1:3,5:17)], by=c("county","state","case", "reliability"), all.x = TRUE)
##load defection cost
defect$load_defect_cost_current <- defect$r_curr_fixed + (1 - defect$reliability) * defect$energy *
defect$pv_lev
defect$load_defect_cost_pmc <- defect$private_fixed + (1 - defect$reliability) * defect$energy *
defect$pv_lev
#take differences
defect$curr_diff <- defect$r_current - defect$grid_defect_cost
defect$private_diff <- defect$r_private - defect$grid_defect_cost
##cost based defection
defect$current_defect_cost <- as.character(ifelse(defect$r_current < defect$load_defect_cost_current &
defect$r_current < defect$grid_defect_cost,0,
ifelse(defect$load_defect_cost_current < defect$grid_defect_cost,1,2)))
defect$private_defect_cost <- as.character(ifelse(defect$r_private < defect$load_defect_cost_pmc &
defect$r_private < defect$grid_defect_cost,0,
ifelse(defect$load_defect_cost_pmc < defect$grid_defect_cost,1,2)))
##with system constraints
defect$current_defect_wconst <- as.character(ifelse(defect$current_defect_cost == 2 &
(defect$pv > 20 | defect$storage > 200) & defect$r_current < defect$load_defect_cost_current,0,
ifelse(defect$current_defect_cost == 2 & (defect$pv > 20 | defect$storage > 200) &
defect$r_current > defect$load_defect_cost_current,1,defect$current_defect_cost)))
defect$private_defect_wconst <- as.character(ifelse(defect$private_defect_cost == 2 &
(defect$pv > 20 | defect$storage > 200) & defect$r_private < defect$load_defect_cost_pmc,0,
ifelse(defect$private_defect_cost == 2 & (defect$pv > 20 | defect$storage > 200) &
defect$r_private > defect$load_defect_cost_pmc,1,defect$private_defect_cost)))
## density plots
rels <- c(0,0.01)
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = private_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = private_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties modeled") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.8), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=10)
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = curr_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = curr_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties modeled") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.8), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=10)
}
## density plots
rels <- c(0,0.01)
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = private_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = private_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties modeled") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.8), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = curr_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = curr_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties modeled") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.8), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
rels <- c(0,0.01)
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = private_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = private_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp1, stat="bin", aes(x = curr_diff,y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp2, stat="bin", aes(x = curr_diff, y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
## density plots
rels <- c(0,0.01)
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
## density plots
rels <- c(0,0.01)
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
levels(defect$case)
test <- as.factor(defect$case)
levels(test)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
## density plots
rels <- c(0,0.01)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
## density plots
rels <- c(0,0.01)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=9)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=9)
}
levels(temp1$case)
## density plots
rels <- c(0,0.01)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=10)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=10)
}
## density plots
rels <- c(0,0.01)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=7)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=7)
}
## density plots
rels <- c(0,0.01)
#specify levels
# Or specify the factor levels in the order you want
defect$case <- factor(defect$case, levels = c("LOW", "BASE", "HIGH"))
for(rel in 1:length(rels)){
temp1 <- subset(defect[reliability==rels[rel]], case == "BASE")
row1 <- as.numeric(nrow(temp1))
temp2 <- subset(defect[reliability==rels[rel]], case == "LOW")
row2 <- as.numeric(nrow(temp2))
temp3 <- subset(defect[reliability==rels[rel]], case == "HIGH")
row3 <- as.numeric(nrow(temp3))
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = private_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = private_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = private_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_private_diff_",rels[rel],".jpg"),width=8)
ggplot() +
geom_area(data = temp2, stat="bin", aes(x = curr_diff,y=..count..,
fill="Low"), alpha=0.55) +
geom_area(data = temp1, stat="bin", aes(x = curr_diff, y=..count..,
fill="Base"), alpha=0.55) +
geom_area(data = temp3, stat="bin", aes(x = curr_diff,y=..count..,
fill="High"), alpha=0.55) +
scale_fill_manual(values=c("aquamarine3","deeppink4", "gold")) +
geom_vline(xintercept=0) + labs(fill="Demand case") +
xlab(label = "solar/storage system cost savings $") + ylab(label = "Number of counties") +
theme(axis.text=element_text(size=22),axis.title=element_text(size=24,face="bold"),
legend.text=element_text(size=24),legend.title=element_text(size=24,face="bold"),
legend.position = c(0.2,0.6), legend.key.size =  unit(1, 'cm')) +
guides(colour = guide_legend(override.aes = list(size=14))) +
scale_x_continuous(limits=c(-15000,1500), labels=dollar_format(prefix = "$")) +
scale_y_continuous(limits=c(0,2000))
ggsave(filename = paste0(DIR,OUT, "\\images\\density_curr_diff_",rels[rel],".jpg"),width=8)
}
