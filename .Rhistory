scale_y_continuous(breaks=seq(0,5,1), limits=c(0,5))
dev.off()
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, rjson, maps,maptools, spatstat,rgeos, broom, data.table)
# Set working directory
DIR <- "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT <- "in\\res_solar"
IN <-  "in\\"
LD<- "LOW"
DIR <- "G:\\Team Drives\\grid_defect_data\\Analysis\\"
IN <-  "in\\"
list <- list.files(paste0(DIR,IN,"all_data\\R files"))
for (i in 1:length(list)) {
out <- readRDS(paste0(DIR, IN,"all_data\\R files\\",list[i]))
write.csv(out,paste0(DIR, IN,"all_data\\",list[i],".csv"))
}
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, ggplot2, usmap, RColorBrewer, data.table, scales)
# Set working directory
#DIR = "C:\\Users\\will-\\GoogleDrive\\UCBerkeley\\2018Spring\\Comp Programing in Econ\\Project\\"
DIR = "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT = "out"
INPUT = "in"
##########################################################
## I. read in output data ################################
##########################################################
#rates
base_rates_100 <- fread(paste0(DIR,OUT,"\\ann_bill_100.csv"))
base_rates_100$reliability <- 0
base_rates_95 <- fread(paste0(DIR,OUT,"\\ann_bill_100.csv"))
base_rates_95$reliability <- 0.05
base_rates <- rbind(base_rates_100, base_rates_95)
rm(base_rates_100,base_rates_95)
#solar/storage systems
sizing <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
fips <- fread(paste0(DIR,OUT,"\\fips.csv"))
#Set costs
BAT_COST = 200 # $/kWh
PV_COST = 1000 # $/kW
#annual rates
int_rate = 0.07 # percentage interest rate
bat_life = 20 # years
sol_life = 25 # years
BAT_RATE = int_rate / (1 - (1+int_rate)^(-bat_life))
PV_RATE = int_rate / (1 - (1+int_rate)^(-sol_life))
sizing$cost <- sizing$pv * PV_COST * PV_RATE + sizing$storage * BAT_COST * BAT_RATE
sizing$reliability <- as.numeric(sizing$reliability)
sizes <- merge(sizing, fips, by=c("county","state"))
##merge in data
defect <- merge(base_rates, sizing[,c(5:9)], by=c("county","state","case", "reliability"), all.x = TRUE)
#take differences
defect$curr_diff <- defect$r_current - defect$cost
defect$r1_diff <- defect$r_1 - defect$cost
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
index = 1
rels = 1
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-10000, label="Defection point", y=.001), colour="black", size=16) +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
rel = 1
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-10000, label="Defection point", y=.001), colour="black", size=16) +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-10000, label="Defection point", y=.001), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-10, label="Defection point", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-1000, label="Defection point", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-5000, label="Defection point", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-3000, label="Defection point", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-3000, label="Defection line", y=.0009, size = 16), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 16, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 10, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 5, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000)
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 5, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 5, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-3000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
## density plots
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line", y=.0009), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
## density plots
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line"), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
## density plots
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line", y = 0.00075), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line", y = 0.00075), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
geom_text(size = 7, aes(x=-5000, label="Defection line", y = 0.00075), colour="black") +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
## density plots
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
rate <- c("r1_diff","curr_diff")
rels <- c(0,0.05)
for (index in 1:length(rate)){
for(rel in 1:length(rels)){
ggplot(defect[reliability==rels[rel]], aes_string(rate[index], colour="case", fill="case")) +
geom_density(alpha=0.55) + geom_vline(xintercept=0) +
xlab(label = "Cost utility electricity - cost solar/stor system") + ylab(label = "Density") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"),
legend.position = c(0.2,0.8)) +
guides(colour = guide_legend(override.aes = list(size=10))) +
scale_x_continuous(limits=c(-30000,1000))
ggsave(filename = paste0(paste0(DIR,OUT, "\\images\\density_",rate[index],"_",rels[rel],".jpg")))
}
}
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, ggplot2, RColorBrewer, data.table, scales)
# Set working directory
#DIR = "C:\\Users\\will-\\GoogleDrive\\UCBerkeley\\2018Spring\\Comp Programing in Econ\\Project\\"
DIR = "G:\\Team Drives\\Beyond LCOE\\OE - Limts of LCOE\\Analysis\\"
OUT = "out"
IN = "in"
##########################################################
## I. read in output data ################################
##########################################################
#rates
#solar/storage systems
costs <- fread(paste0(DIR,OUT,"\\exeter_result.csv"))
View(costs)
colnames(costs)<- c("project","unit_cost","lev_cost","type")
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold"))
give.n <- function(x){
return(c(y = mean(x), label = length(x)))
}
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text")
#(storage)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", position = position_dodge(width = 0.75))
#(storage)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", position = position_dodge(height = 2))
#(storage)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", position  = position_jitter(height=1, width = 0))
#(storage)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", size=20)
#(storage)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", size=10)
#(unit cost)
ggplot(costs, aes(x=type, y=lev_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", size=10)
#(unit cost)
ggplot(costs, aes(x=type, y=lev_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Levelized Cost ($/MWh)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", size=10)
ggsave(filename = paste0(DIR,OUT, "\\images\\LCOE.jpg"))
#(unit cost)
ggplot(costs, aes(x=type, y=unit_cost)) +
geom_boxplot() + xlab(label = "Fuel Type") + ylab(label = "Unit Cost ($/kW)") +
theme(axis.text=element_text(size=18),axis.title=element_text(size=20,face="bold"),
legend.text=element_text(size=20),legend.title=element_text(size=20,face="bold")) +
stat_summary(fun.data = give.n, geom = "text", size=10)
ggsave(filename = paste0(DIR,OUT, "\\images\\UNIT_COST.jpg"))
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, ggplot2, usmap, RColorBrewer, data.table, scales)
# Set working directory
#DIR = "C:\\Users\\will-\\GoogleDrive\\UCBerkeley\\2018Spring\\Comp Programing in Econ\\Project\\"
DIR = "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT = "out"
INPUT = "in"
#solar/storage systems
sizing <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
fips <- fread(paste0(DIR,OUT,"\\fips.csv"))
#alternative sizes
sizing_1 <- fread(paste0(DIR,OUT,"\\1500pv_200stor.csv"))
sizing_2 <- fread(paste0(DIR,OUT,"\\3000pv_450stor.csv"))
#solar/storage systems
sizing <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
sizing$version <- "500pv_100stor"
fips <- fread(paste0(DIR,OUT,"\\fips.csv"))
#alternative sizes
sizing_1 <- fread(paste0(DIR,OUT,"\\1500pv_200stor.csv"))
sizing$version <- "1500pv_200stor"
sizing_2 <- fread(paste0(DIR,OUT,"\\3000pv_450stor.csv"))
sizing$version <- "3000pv_450stor"
compiled <- rbind(sizing, sizing_1)
compiled <- rbind(compiled, sizing_2)
#solar/storage systems
sizing <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
sizing$version <- "500pv_100stor"
fips <- fread(paste0(DIR,OUT,"\\fips.csv"))
#alternative sizes
sizing_1 <- fread(paste0(DIR,OUT,"\\1500pv_200stor.csv"))
sizing_1$version <- "1500pv_200stor"
sizing_2 <- fread(paste0(DIR,OUT,"\\3000pv_450stor.csv"))
sizing_2$version <- "3000pv_450stor"
compiled <- rbind(sizing, sizing_1)
compiled <- rbind(compiled, sizing_2)
r_stats <- compiled %>% group_by(reliability, case, version) %>%
summarize(med_sol = median(pv),med_stor = median(storage),max_sol = max(pv), max_stor = max(storage),
min_sol = min(pv),min_stor = min(storage))
View(r_stats)
write.csv(r_stats,filename = paste0(DIR,OUT, "size_cost.csv") )
write.csv(r_stats,file = paste0(DIR,OUT, "size_cost.csv"))
write.csv(r_stats,file = paste0(DIR,OUT, "\\size_cost.csv"))
#solar/storage systems
sizing_3 <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
sizing_3$version <- "500pv_100stor"
sizing_1 <- fread(paste0(DIR,OUT,"\\1500pv_200stor.csv"))
sizing_1$version <- "1500pv_200stor"
sizing_2 <- fread(paste0(DIR,OUT,"\\3000pv_450stor.csv"))
sizing_2$version <- "3000pv_450stor"
# Clear workspace
rm(list = ls())
# Packages
library(pacman)
p_load(magrittr, dplyr, stringr, ggplot2, usmap, RColorBrewer, data.table, scales)
# Set working directory
#DIR = "C:\\Users\\will-\\GoogleDrive\\UCBerkeley\\2018Spring\\Comp Programing in Econ\\Project\\"
DIR = "C:\\Users\\Will\\GoogleDrive\\UCBerkeley\\Research\\Papers\\2018 Off-grid\\Analysis\\"
OUT = "out"
INPUT = "in"
##########################################################
## I. read in output data ################################
##########################################################
#rates
base_rates_100 <- fread(paste0(DIR,OUT,"\\ann_bill_100.csv"))
base_rates_100$reliability <- 0
base_rates_95 <- fread(paste0(DIR,OUT,"\\ann_bill_100.csv"))
base_rates_95$reliability <- 0.05
base_rates <- rbind(base_rates_100, base_rates_95)
rm(base_rates_100,base_rates_95)
#solar/storage systems
sizing_3 <- fread(paste0(DIR,OUT,"\\500pv_100stor.csv"))
sizing_3$version <- "500pv_100stor"
sizing_1 <- fread(paste0(DIR,OUT,"\\1500pv_200stor.csv"))
sizing_1$version <- "1500pv_200stor"
sizing_2 <- fread(paste0(DIR,OUT,"\\3000pv_450stor.csv"))
sizing_2$version <- "3000pv_450stor"
#fip codes
fips <- fread(paste0(DIR,OUT,"\\fips.csv"))
#select analysis sample
sizing <- sizing_3
#Set costs
BAT_COST = 200 # $/kWh
PV_COST = 1000 # $/kW
#annual rates
int_rate = 0.07 # percentage interest rate
bat_life = 20 # years
sol_life = 25 # years
BAT_RATE = int_rate / (1 - (1+int_rate)^(-bat_life))
PV_RATE = int_rate / (1 - (1+int_rate)^(-sol_life))
sizing$cost <- sizing$pv * PV_COST * PV_RATE + sizing$storage * BAT_COST * BAT_RATE
sizing$reliability <- as.numeric(sizing$reliability)
sizes <- merge(sizing, fips, by=c("county","state"))
##merge in data
defect <- merge(base_rates, sizing[,c(5:8,10)], by=c("county","state","case", "reliability"), all.x = TRUE)
#take differences
defect$curr_diff <- defect$r_current - defect$cost
defect$r1_diff <- defect$r_1 - defect$cost
defect$r0.75_diff <- defect$r_0.75 - defect$cost
defect$r0.5_diff <- defect$r_0.5 - defect$cost
defect$r0.25_diff <- defect$r_0.25 - defect$cost
defect$r0_diff <- defect$r_0 - defect$cost
#write to csv
write.csv(defect,file = paste0(DIR,OUT, "\\defection.csv") )
test <- numeric(3)
